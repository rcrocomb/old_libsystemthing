<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CIL Systems Programming Library: source/timing.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>source/timing.cpp File Reference</h1><code>#include &quot;<a class="el" href="timing_8h-source.html">timing.h</a>&quot;</code><br>
<code>#include &lt;stdint.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;sys/select.h&gt;</code><br>
<code>#include &lt;sys/time.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;asm-x86_64/msr.h&gt;</code><br>
<code>#include &quot;<a class="el" href="program__IO_8h-source.html">program_IO.h</a>&quot;</code><br>
<code>#include &lt;string&gt;</code><br>

<p>
Include dependency graph for timing.cpp:<p><center><img src="timing_8cpp__incl.png" border="0" usemap="#source/timing.cpp_map" alt=""></center>
<map name="source/timing.cpp_map">
<area href="timing_8h.html" shape="rect" coords="232,5,309,32" alt="">
<area href="program__IO_8h.html" shape="rect" coords="215,436,327,463" alt="">
</map>

<p>
<a href="timing_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetiming__name.html">timing_name</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#23050c0028c1d8f2a37561dfd7f2ecc8">TIME_NAME</a>&nbsp;&nbsp;&nbsp;timing_name::NAME</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#1e225a39402b9f8f607ece483f4947c0">TIME_CPRINT</a>(fmt, args...)&nbsp;&nbsp;&nbsp;CPRINT_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#a813920dce3c6e30b92c8661593efea0">TIME_VPRINT</a>(fmt, args...)&nbsp;&nbsp;&nbsp;VPRINT_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#736402bcc73d20f09bd80dac8f7fcf10">TIME_WARNING</a>(fmt, args...)&nbsp;&nbsp;&nbsp;WARNING_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#4259027b487a61cef076fbaa7e898322">TIME_ERROR</a>(fmt, args...)&nbsp;&nbsp;&nbsp;ERROR_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#d6aee4b82af49a21e80fcfd6d496c85a">TIME_RUNTIME</a>(fmt, args...)&nbsp;&nbsp;&nbsp;RUNTIME_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#45d34a0b8065baffdb34bc2838d933aa">TIME_REPORT</a>(fmt, args...)&nbsp;&nbsp;&nbsp;REPORT_WITH_NAME(TIME_NAME, fmt, ## args)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#e03ffe08993a6b03bd5f62b6c265dbad">TIME_DP</a>(level, fmt, args...)&nbsp;&nbsp;&nbsp;DP(level, TIME_NAME, fmt, ## args)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetiming__name.html#1a62f839cfaebc642ba46a12c480e58c">timing_name::NAME</a> (&quot;timing&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#2104b230a444de46c85316f0a0348e87">gimme_timeofday</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#503b4ec495a9ee474d4038f5cb61fa6c">selectsleep</a> (unsigned us)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#0b487ac89ee1b2a7849fc06108f74961">get_time</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#eed540fadde481f79e018e2e45e6298e">init_timer</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="timing_8cpp.html#96235dbe8d2e9113d05a49df8911419f">busy_delay</a> (double seconds)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="1e225a39402b9f8f607ece483f4947c0"></a><!-- doxytag: member="timing.cpp::TIME_CPRINT" ref="1e225a39402b9f8f607ece483f4947c0" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_CPRINT          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;CPRINT_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00020">20</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
Referenced by <a class="el" href="timing_8cpp-source.html#l00089">init_timer()</a>.
</div>
</div><p>
<a class="anchor" name="e03ffe08993a6b03bd5f62b6c265dbad"></a><!-- doxytag: member="timing.cpp::TIME_DP" ref="e03ffe08993a6b03bd5f62b6c265dbad" args="(level, fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_DP          </td>
          <td>(</td>
          <td class="paramtype">level,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;DP(level, TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00026">26</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="4259027b487a61cef076fbaa7e898322"></a><!-- doxytag: member="timing.cpp::TIME_ERROR" ref="4259027b487a61cef076fbaa7e898322" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_ERROR          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;ERROR_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00023">23</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="23050c0028c1d8f2a37561dfd7f2ecc8"></a><!-- doxytag: member="timing.cpp::TIME_NAME" ref="23050c0028c1d8f2a37561dfd7f2ecc8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_NAME&nbsp;&nbsp;&nbsp;timing_name::NAME          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00019">19</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="45d34a0b8065baffdb34bc2838d933aa"></a><!-- doxytag: member="timing.cpp::TIME_REPORT" ref="45d34a0b8065baffdb34bc2838d933aa" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_REPORT          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;REPORT_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00025">25</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="d6aee4b82af49a21e80fcfd6d496c85a"></a><!-- doxytag: member="timing.cpp::TIME_RUNTIME" ref="d6aee4b82af49a21e80fcfd6d496c85a" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_RUNTIME          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;RUNTIME_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00024">24</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="a813920dce3c6e30b92c8661593efea0"></a><!-- doxytag: member="timing.cpp::TIME_VPRINT" ref="a813920dce3c6e30b92c8661593efea0" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_VPRINT          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;VPRINT_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00021">21</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<a class="anchor" name="736402bcc73d20f09bd80dac8f7fcf10"></a><!-- doxytag: member="timing.cpp::TIME_WARNING" ref="736402bcc73d20f09bd80dac8f7fcf10" args="(fmt, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIME_WARNING          </td>
          <td>(</td>
          <td class="paramtype">fmt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;WARNING_WITH_NAME(TIME_NAME, fmt, ## args)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00022">22</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="96235dbe8d2e9113d05a49df8911419f"></a><!-- doxytag: member="timing.cpp::busy_delay" ref="96235dbe8d2e9113d05a49df8911419f" args="(double seconds)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void busy_delay           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>seconds</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00131">131</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
References <a class="el" href="timing_8cpp-source.html#l00057">get_time()</a>.<div class="fragment"><pre class="fragment"><a name="l00132"></a>00132 {
<a name="l00133"></a>00133     <span class="keywordflow">if</span> (seconds &lt; 0)
<a name="l00134"></a>00134         <span class="keywordflow">return</span>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="keywordflow">if</span> (seconds == 0)
<a name="l00137"></a>00137         <span class="keywordflow">return</span>;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="keywordtype">double</span> start = <a class="code" href="timing_8h.html#0b487ac89ee1b2a7849fc06108f74961">get_time</a>();
<a name="l00140"></a>00140     <span class="keywordflow">for</span> ( ; ; )
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142         <span class="keywordtype">double</span> now = <a class="code" href="timing_8h.html#0b487ac89ee1b2a7849fc06108f74961">get_time</a>();
<a name="l00143"></a>00143         <span class="keywordtype">double</span> diff = now - start;
<a name="l00144"></a>00144         <span class="keywordflow">if</span> (diff &gt; seconds)
<a name="l00145"></a>00145             <span class="keywordflow">break</span>;
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="timing_8cpp_96235dbe8d2e9113d05a49df8911419f_cgraph.png" border="0" usemap="#timing_8cpp_96235dbe8d2e9113d05a49df8911419f_cgraph_map" alt=""></center>
<map name="timing_8cpp_96235dbe8d2e9113d05a49df8911419f_cgraph_map">
<area href="timing_8h.html#0b487ac89ee1b2a7849fc06108f74961" shape="rect" coords="153,5,233,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="0b487ac89ee1b2a7849fc06108f74961"></a><!-- doxytag: member="timing.cpp::get_time" ref="0b487ac89ee1b2a7849fc06108f74961" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_time           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00057">57</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
Referenced by <a class="el" href="timing_8cpp-source.html#l00131">busy_delay()</a>.<div class="fragment"><pre class="fragment"><a name="l00058"></a>00058 {
<a name="l00059"></a>00059     uint64_t t;
<a name="l00060"></a>00060     rdtscll(t);
<a name="l00061"></a>00061     <span class="keywordflow">return</span> t * seconds_per_tick;
<a name="l00062"></a>00062 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2104b230a444de46c85316f0a0348e87"></a><!-- doxytag: member="timing.cpp::gimme_timeofday" ref="2104b230a444de46c85316f0a0348e87" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gimme_timeofday           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00048">48</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
Referenced by <a class="el" href="timing_8cpp-source.html#l00089">init_timer()</a>.<div class="fragment"><pre class="fragment"><a name="l00049"></a>00049 {
<a name="l00050"></a>00050     <span class="keyword">struct </span>timeval tv;
<a name="l00051"></a>00051     gettimeofday(&amp;tv, 0);
<a name="l00052"></a>00052     <span class="keywordflow">return</span> tv.tv_sec + SECS_PER_NANO * tv.tv_usec;
<a name="l00053"></a>00053 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="eed540fadde481f79e018e2e45e6298e"></a><!-- doxytag: member="timing.cpp::init_timer" ref="eed540fadde481f79e018e2e45e6298e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_timer           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Figure out how fast rdtscll() ticks. This should be equal to the frequency of the clock on the processor. Here's the bad news: I don't know if rdtscll() always uses the same processor so it may very well be necessary to set a processor affinity to get really good results over time.<p>
This piece of code by Mark Hahn. 
<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00089">89</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
References <a class="el" href="timing_8cpp-source.html#l00048">gimme_timeofday()</a>, <a class="el" href="timing_8cpp-source.html#l00070">selectsleep()</a>, and <a class="el" href="timing_8cpp-source.html#l00020">TIME_CPRINT</a>.<div class="fragment"><pre class="fragment"><a name="l00090"></a>00090 {
<a name="l00091"></a>00091         <span class="keywordtype">double</span> sumx = 0;
<a name="l00092"></a>00092         <span class="keywordtype">double</span> sumy = 0;
<a name="l00093"></a>00093         <span class="keywordtype">double</span> sumxx = 0;
<a name="l00094"></a>00094         <span class="keywordtype">double</span> sumxy = 0;
<a name="l00095"></a>00095         <span class="keywordtype">double</span> slope;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         <span class="comment">// least squares linear regression of ticks onto real time</span>
<a name="l00098"></a>00098         <span class="comment">// as returned by gettimeofday.</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n = 30;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         <a class="code" href="timing_8cpp.html#1e225a39402b9f8f607ece483f4947c0">TIME_CPRINT</a>(<span class="stringliteral">"Calibrating cycle counter vs. clock\n"</span>);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n; ++i)
<a name="l00105"></a>00105         {
<a name="l00106"></a>00106                 <span class="keywordtype">double</span> breal,real,ticks;
<a name="l00107"></a>00107                 uint64_t aticks, bticks;
<a name="l00108"></a>00108         
<a name="l00109"></a>00109                 breal = <a class="code" href="timing_8cpp.html#2104b230a444de46c85316f0a0348e87">gimme_timeofday</a>();
<a name="l00110"></a>00110                 rdtscll(bticks);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112                 <a class="code" href="timing_8cpp.html#503b4ec495a9ee474d4038f5cb61fa6c">selectsleep</a>((<span class="keywordtype">unsigned</span>)(10000 + drand48() * 200000));
<a name="l00113"></a>00113 
<a name="l00114"></a>00114                 rdtscll(aticks);
<a name="l00115"></a>00115                 ticks = aticks - bticks;
<a name="l00116"></a>00116                 real = <a class="code" href="timing_8cpp.html#2104b230a444de46c85316f0a0348e87">gimme_timeofday</a>() - breal;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118                 sumx += real;
<a name="l00119"></a>00119                 sumxx += real * real;
<a name="l00120"></a>00120                 sumxy += real * ticks;
<a name="l00121"></a>00121                 sumy += ticks;
<a name="l00122"></a>00122         }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124         slope = ((sumxy - (sumx * sumy) / n) / (sumxx - (sumx * sumx) / n));
<a name="l00125"></a>00125         seconds_per_tick = 1.0 / slope;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <a class="code" href="timing_8cpp.html#1e225a39402b9f8f607ece483f4947c0">TIME_CPRINT</a>(<span class="stringliteral">"Calibrated timer as %.6f GHz\n\n"</span>, slope * GIGS_PER_HZ);
<a name="l00128"></a>00128 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="timing_8cpp_eed540fadde481f79e018e2e45e6298e_cgraph.png" border="0" usemap="#timing_8cpp_eed540fadde481f79e018e2e45e6298e_cgraph_map" alt=""></center>
<map name="timing_8cpp_eed540fadde481f79e018e2e45e6298e_cgraph_map">
<area href="timing_8cpp.html#2104b230a444de46c85316f0a0348e87" shape="rect" coords="142,5,286,32" alt="">
<area href="timing_8cpp.html#503b4ec495a9ee474d4038f5cb61fa6c" shape="rect" coords="164,56,263,83" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="503b4ec495a9ee474d4038f5cb61fa6c"></a><!-- doxytag: member="timing.cpp::selectsleep" ref="503b4ec495a9ee474d4038f5cb61fa6c" args="(unsigned us)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void selectsleep           </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>us</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A good way to simply hang around doing nothing for awhile. 
<p>
Definition at line <a class="el" href="timing_8cpp-source.html#l00070">70</a> of file <a class="el" href="timing_8cpp-source.html">timing.cpp</a>.
<p>
Referenced by <a class="el" href="timing_8cpp-source.html#l00089">init_timer()</a>.<div class="fragment"><pre class="fragment"><a name="l00071"></a>00071 {
<a name="l00072"></a>00072         <span class="keyword">struct </span>timeval tv;
<a name="l00073"></a>00073         tv.tv_sec = 0;
<a name="l00074"></a>00074         tv.tv_usec = us;
<a name="l00075"></a>00075         select(0, 0, 0, 0, &amp;tv);
<a name="l00076"></a>00076 }
</pre></div>
<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Thu Apr 5 09:39:48 2007 for CIL Systems Programming Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
